<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/gooddetails.css">
	<link rel="stylesheet" href="css/share.css">
</head>
<body>

	<!-- 公共部分 -->
	<!-- 头部可关闭广告 -->
		<div id="headad">
			<a href="##"><img src="img/M11_27_140730.png"/>
				<p id="closepic"><img src="img/colse.gif"></p>
			</a>
		</div>
	<!--*******************-->
	<!---头部导航条 -->
		<div class="headnavbg">
			<div class="headnav">
				<ul class="headnav-left">
					<li>
						<i></i>
						<a href="index.html">梦芭莎首页</a>
					</li>
					<li>
						<i></i>
						<a href="##">100%正品保证 10年品质保证</a>
					</li>
				</ul>
				<ul class="headnav-right">
					<li><a>登录</a></li>
					<li class="rightline">|</li>
					<li><a>注册</a></li>
					<li class="rightline">|</li>
					<li><i></i><a href="##">微信</a><img src="img/160919171653.jpg"></li>
					<li class="rightline">|</li>
					<li><i></i><a href="##">微博</a><img src="img/0826143310.jpg"></li>
					<li class="rightline">|</li>
					<li><i></i><a href="##">手机版</a><img src="img/download.gif"></li>
					<li class="rightline">|</li>
					<li><a href="##">收藏梦芭莎</a></li>
					<li class="rightline">|</li>
					<li><i></i><a href="shopcar.html">购物车</a></li>
					<li class="rightline">|</li>
					<li><i></i><a href="##">全部分类</a></li>
				</ul>
			</div>
		</div>
	<!--*******************-->
	<!-- 头部+logo -->
		<div class="headerbg">
			<div class="header">
				<div class="header-left">
					<a href="index.html"><img src="img/logomoonbasa.png"></a>
					<p>
						<span>梦芭莎饰品</span>
						<span>梦芭莎自营品牌</span>
					</p>
				</div>
				<div class="header-right">
					<div class="searchtxt">
						<p>
							<input id="searchinput" type="text" placeholder="领200红包，购冬尚搭配，让你美得不一样！">
						</p>
						<p>
							<input id="searchbtn" type="button" value="搜全站">
						</p>
					</div>
					<p id="search_inshop">搜本店</p>
				</div>
			</div>
		</div>
	<div class="detailshopname">
		<a href="##" id="shoplogo"><!-- <img src="listimg/shoplogo1.jpg"/>  --></a>
	</div>
	<div class="info">
		<div class="picbg" id="picbg">
			<div id="max">
				<!-- <img src="" class="maxmiddle" width="760" height="1026"> -->
			</div>
			<div id="box">
				<p class="filter"></p>
				<!-- <img src="listimg/middlehat1-1.jpg" class="middle" width="380" height="513"> -->
			</div>
			<div id="smallbg">
				<div class="smd">
					<ul id="smlist">
						<!-- <li>
							<img src="listimg/detailsmallhat1-1.jpg" class="small"  data-url="listimg/largehat1-1.jpg">
						</li>
						<li>
							<img src="listimg/detailsmallhat1-1.jpg" class="small"  data-url="listimg/largehat1-1.jpg">
						</li>
						<li>
							<img src="listimg/detailsmallhat1-1.jpg" class="small"  data-url="listimg/largehat1-1.jpg">
						</li> -->
					</ul>
				</div>
				<p class="change" id="direction">
					<a href="##"><</a>
					<a href="##">></a>
				</p>
			</div>
		</div>
		<div class="detailinfo">
			<!-- <h2>韩伊儿日韩时尚流行个性保暖茧型金属圈装饰大帽子长羽绒</h2>
			<p id="detailprice">￥799</p> -->
			<!-- <div class="detailothers">
				<p class="detailothercolor">
					<i>颜色：</i>
					<span>军绿色</span>
					<span>黑色</span>
				</p>
				<p class="size">
					<i>尺码：</i>
					<span>S</span>
					<span>M</span>
					<span>L</span>
					<span>XL</span>
				</p>
				<p class="num">
					<i>数量：</i>
					<span>-</span><span>1</span><span>+</span>	
				</p>
				<p class="butt">
					<span id="buynow">立刻购买</span>
					<span id="addcar">加入购物车</span>
					<i>*成功加入购物车</i>
				</p>
			</div> -->
		</div>
	</div>
	<div id="detaillargepic">
		<p id="gooddetailinfo"><span>商品展示</span><span>梦芭莎价格比对</span>
		<span>如何支付</span><span>七天无条件退货</span></p>
		<div class="detaillargepicinfo menu"></div>
		<div class="paremeter menu">
			<img src="img/moongoodprice.jpg"/>
		</div>
		<div class="howpay menu">
			<img src="img/howpay.jpg"/>
		</div>
		<div class="reback menu">
			<img src="img/goodreback.jpg"/>
		</div>
	</div>
<!-- 尾部 -->
	<div class="footer">
		<div class="copyright">
			<a href="index.html">首页</a>
			<a href="##">公司简介</a>
			<a href="##">旗下品牌</a>
			<a href="##">零售店址</a>
			<a href="##">梦芭莎网盟</a>
			<a href="##">网店代理</a>
			<a href="##">网站地图</a>
			<a href="##">友情链接</a>
			<br>
			Copyright &copy; 2010-2019 梦芭莎官方网站，广州摩拉网络科技有限公司 All Rights Reserved 粤B2-20080069号 <img src="img/beian.png">粤公网安备44010302000075
		</div>
		<div class="iconpic">
			<img src="img/mbs_f_01.jpg">
			<img src="img/mbs_f_02.jpg">
			<img class="logodown" src="img/logo_down.jpg">
			<img src="img/logo.jpg">
			<img src="img/mbs_f_04.jpg">
			<img src="img/mbs_f_05.jpg">
			<img src="img/mbs_f_06.jpg">
			<img src="img/mbs_f_07.jpg">
		</div>
	</div>
</body>
</html>
<script src="js/pool.js"></script>
<script src="js/share.js"></script>
<script src="js/ajax.js"></script>
<script>
var clickid=decodeURI(location.href.split('?')[1], "UTF-8");
var shoplogo=document.getElementById("shoplogo");
var max=document.getElementById("max");
var box=document.getElementById("box");
var smlist=document.getElementById("smlist");
var smallbg=document.getElementById("smallbg");
var detailinfo=document.querySelector(".detailinfo");
var detaillargepic=document.getElementById("detaillargepic");
var detaillargepicinfo=document.querySelector("#detaillargepic>.detaillargepicinfo");
var flag={};
ajax("get","data.json",'',function(goods){
	for(var i in goods){
		for(var j in goods[i].typeinfo){
			for(var k in goods[i].typeinfo[j].info){
				if(goods[i].typeinfo[j].info[k].id==clickid){
					shoplogo.innerHTML='<img src="'+goods[i].typeinfo[j].info[k].shoplogo+'"/>';
					max.innerHTML='<img src="'+goods[i].typeinfo[j].info[k].largehat[0]+'" class="maxmiddle" width="760" height="1026">';
					box.innerHTML+='<img src="'+goods[i].typeinfo[j].info[k].middlehat[0]+'"  class="middle" width="380" height="513">';
					//商品大图
					for(var sli in goods[i].typeinfo[j].info[k].detailsmallhat){
						detaillargepicinfo.innerHTML+='<img src="'+goods[i].typeinfo[j].info[k].largehat[sli]+'"/>';
					}
					var smstr='';
					for(var smi in goods[i].typeinfo[j].info[k].detailsmallhat){
						smstr+='<li class="smdli"><img src="'+goods[i].typeinfo[j].info[k].detailsmallhat[smi]+'" class="small"  data-url="'+goods[i].typeinfo[j].info[k].largehat[smi]+'"></li>';
					}
					smlist.innerHTML=smstr;
					var strcolor='';
					var strsize='';
					for(var scolori in goods[i].typeinfo[j].info[k].color){
						strcolor+='<span>'+goods[i].typeinfo[j].info[k].color[scolori]+'</span>';
					}
					for(var ssizei in goods[i].typeinfo[j].info[k].size){
						strsize+='<span>'+goods[i].typeinfo[j].info[k].size[ssizei]+'</span>';
					}
					detailinfo.innerHTML='<h2>'+goods[i].typeinfo[j].info[k].detail+'</h2><p id="detailprice">￥'+goods[i].typeinfo[j].info[k].price+'</p>'+'<div class="detailothers"><p class="detailothercolor"><i>颜色：</i>'+strcolor+'</p><p class="size"><i>尺码：</i>'+strsize+'</p><p class="num"><i>数量：</i><span>-</span><span>1</span><span>+</span></p><p class="butt"><span id="buynow">立刻购买</span><span id="addcar">加入购物车</span><span id="message">加入购物车成功！</span></p></div>';
				}
			}
		}
	}
	/*上下一张*/
	var oBanner=document.getElementById("smallbg");
	var oLi=smlist.getElementsByTagName("li");

	var dir=document.querySelectorAll("#direction>a");
	var iNow=0;
	var timer=null;

	smlist.style.width=oLi.length*(oLi[0].offsetWidth+12)+'px';

	dir[0].onclick=function(){
		if(iNow==0){
			dir[0].click=null;
			oUl.style.left=0;
		}else{
			iNow--;
		}
		toImg();
	}
	dir[1].onclick=function(){
		if(oLi.length-4>0){
			if(iNow==oLi.length-4){
				dir[1].onclick=null;
				oUl.style.left=-iNow*oLi[0].offsetWidth+'px';
			}else{
				iNow++;
			}
		}else{
			oUl.style.left=0;
		}
		
		toImg();
	}

	function toImg(){
		move(oUl,{"left":-iNow*oLi[0].offsetWidth});
	}

	/*--------------加入购物车---------------------*/
	var colors=document.querySelectorAll('.detailothercolor>span');
	var goodcolor='';
	var goodsize='';
	for(var i=0;i<colors.length;i++){
		colors[i].onclick=function(){
			for(var j=0;j<colors.length;j++){
				colors[j].style.borderColor="#ccc";
				colors[j].style.color="#6a6a6a";
			}
			this.style.borderColor="#E40165";
			this.style.color="#E40165";
			goodcolor=this.innerHTML;
			flag.color=true;
			return flag.color;
		}
	}

	var sizes=document.querySelectorAll('.size>span');
	for(var i=0;i<sizes.length;i++){
		sizes[i].onclick=function(){
			for(var j=0;j<sizes.length;j++){
				sizes[j].style.borderColor="#ccc";
				sizes[j].style.color="#6a6a6a";
			}
			this.style.borderColor="#E40165";
			this.style.color="#E40165";
			goodsize=this.innerHTML;
			flag.size=true;
			return flag.size;
		}
	}
	var nums=document.querySelectorAll('.num>span');
	nums[0].onclick=function(){
		this.style.cursor="pointer";
		var countnum=parseInt(nums[1].innerHTML);
		if(countnum<=1){
			countnum=1;
		}else{
			countnum--;
		}
		nums[1].innerHTML=countnum;
	}
	nums[2].onclick=function(){
		this.style.cursor="pointer";
		var countnum=parseInt(nums[1].innerHTML);
		countnum++;
		nums[1].innerHTML=countnum;
	}
	var addcar=document.getElementById("addcar");
	var arr=[];
	addcar.onclick=function(){	
		if(flag.color && flag.size){
			var gooddetailname=document.querySelector(".detailinfo>h2").innerHTML;
			var goodprice=document.getElementById('detailprice').innerHTML;
			var n=parseInt(document.querySelectorAll(".num>span")[1].innerHTML);
			var obj={};
			var num=decodeURI(location.href.split('?')[1], "UTF-8");
			var id="id";
			var count="count";
			var color='color';
			var size='size';
			var detailname="detailname";
			var price="price";
			obj[id]=num;
			if(!obj[count]){
				obj[count]=n;
			}else{
				obj[count]=nums[1].innerHTML;
			}
			obj[color]=goodcolor;
			obj[size]=goodsize;
			obj[detailname]=gooddetailname;
			obj[price]=goodprice;
			arr.push(obj);
			var schar='';
			for(var i=0;i<arr.length;i++){
				schar+=JSON.stringify(arr[i])+'-';
			}
			var cook= getCookie('carlist');
			if(!getCookie('carlist')){
				//console.log('第一次存')
				setCookie('carlist',schar,7);
			}else{
				//console.log(isIncooie('carlist',obj[id]))
				//if(isIncooie('carlist',obj){
				var oldstr=isIncooie('carlist',obj);
				//console.log(oldstr)
				setCookie('carlist',oldstr);
				}	
				//console.log(getCookie('carlist')+'+++++++++++++')
				var message=document.getElementById("message");
				message.style.display="block";
				setTimeout(function(){
					message.style.display="none";
				},1500)
			}
		}
	}
);

<!-- 放大镜 -->
var picbg=document.getElementById("picbg");
var smallbg=document.getElementById("smallbg");
var small=smallbg.getElementsByTagName("img");
var box=document.getElementById("box");
var middle=box.getElementsByTagName("img");
var max=document.getElementById("max");
var maxpic=max.getElementsByTagName("img");
smallbg.onmouseover=function(e){
	var e=e||event;
	var target=e.target||e.srcElement;	
	if(target.tagName=="IMG"){
		middle[0].src=target.getAttribute('data-url');
		maxpic[0].src=target.getAttribute('data-url');
	}
	/*smallbg.onmouseout=function(){
		max.style.display="none";
		var filter=box.getElementsByTagName("p");
		filter[0].style.display="none";
	}*/
}

box.onmouseover=function(e){
	var e=e||event;
	var target=e.target||e.srcElement;
	max.style.display="block";
	var filter=box.getElementsByTagName("p");
	filter[0].style.display="block";
	document.onmousemove=function(e){
		var e=e||event;
		var scrolltop=document.body.scrollTop||document.documentElement.scrollTop;
		var target=e.target||e.srcElement;
		var l=e.clientX-picbg.offsetLeft-middle[0].offsetLeft-filter[0].offsetWidth/2;
		var t=e.clientY-picbg.offsetTop-middle[0].offsetTop-filter[0].offsetHeight/2+scrolltop;		
		if(l<=0){l=0;}
		if(l>=middle[0].offsetWidth-filter[0].offsetWidth){
			l=middle[0].offsetWidth-filter[0].offsetWidth;
		}
		if(t<=0){t=0;}
		if(t>=middle[0].offsetHeight-filter[0].offsetHeight){
			t=middle[0].offsetHeight-filter[0].offsetHeight;
		}
		filter[0].style.top=t+'px';
		filter[0].style.left=l+"px";

		maxpic[0].style.top=-t*2+"px";
		maxpic[0].style.left=-l*2+'px';		
	}	
	box.onmouseout=function(){
		document.onmousemove=null;
		max.style.display="none";
		filter[0].style.display="none";
	}
}
//详情切换
var aspan=document.getElementById("gooddetailinfo").querySelectorAll("span");
var aDiv=detaillargepic.querySelectorAll(".menu");
for(var ai=0;ai<aspan.length;ai++){
	aspan[ai].onclick=function(){
		this.index=ai;
		for(var aj=0;aj<aspan.length;aj++){
			aspan[aj].style.background="#e8e8e8";
			aspan[aj].style.borderTop="2px solid #e8e8e8";
			aDiv[aj].style.display="none";		
		}
		this.style.background="#fff";
		this.style.borderTop="2px solid #e50065";
		if(!this.previousElementSibling){
			aDiv[0].style.display="block";
		}else{
			if(!this.nextElementSibling){
				aDiv[3].style.display="block";
			}else{
				if(!this.previousElementSibling.previousElementSibling){
					aDiv[1].style.display="block";
				}
				else{
					aDiv[2].style.display="block";
				}
			}
		}
	}
}
</script>
